\chapter{The 2-level model with migration}\label{ch:3_2Lvl_model}

While the base model in Chapter \ref{ch:2_base_model} demonstrated that environmental variability (EV) can promote intergroup cooperation, its exclusion of migration constitutes a significant simplification.
During the Middle Stone Age (MSA), human populations likely responded to resource scarcity by migrating to more favorable environments.
Therefore, this chapter introduces migration into the base model to examine how EV and migration jointly influence the evolution of cooperation.

\section{Model}\label{sec:3_model}

Migration can be modeled in various ways, depending on key design choices such as spatial structure, the unit of migration, migration triggers, and destination selection mechanisms.

First, regarding spatial structure, previous studies have primarily employed either patch structures \cite{Dugatkin1991}, where agents move between discrete locations, or two-dimensional continuous spaces \cite{Vainstein2001, Vainstein2007}, where agents move across a grid or plane.
To extend the base model from Chapter~\ref{ch:2_base_model} in a straightforward manner, this chapter adopts a patch structure where each regional group contains multiple low-level agents who can migrate between neighboring groups.
The two-dimensional spatial approach is examined in Chapter~\ref{ch:4_2D_model}.

Second, the unit of migration can be defined at different scales, such as individuals, families, or entire groups.
In the MSA context, individual humans would rarely migrate alone due to survival constraints, and unified decision-making and simultaneous migration by large groups would be equally implausible given the complexity of group coordination.
In this chapter, we do not strictly define what the unit of migration corresponds to in the real world, but conceptualize it as a small kin-based unit, such as a family or extended family group.
For convenience, we refer to this unit of migration as an individual, even though this unit is not necessarily a single person.

Third and fourth, migration triggers and destination selection mechanisms determine when and where individuals migrate.
In this chapter, individuals migrate, triggered by resource scarcity, toward resource-rich areas, as this research conceptualizes EV as fluctuations in resource availability.

These design choices result in a two-level hierarchical structure with group agents and individual agents.
EV affects resource allocation at both levels.
Game and strategy update occur independently at both levels.
Migration occurs at the individual level between groups.

\subsection*{Structural overview}\label{sec:structure}

We consider the model composed of multiple regional groups, each inhabited by a number of humans who may migrate between the groups in response to environmental or social pressures.
Within this world, the population is represented by group agents and individual agents, and their interaction (see Subsection~\ref{sec:game}) and migration (see Subsection~\ref{sec:migration}) are governed by the geographical and interaction structures (see Figure~\ref{fig:3_model}).

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.9\textwidth]{figures/3/Model}
  \caption[Illustration of the model structure]{
Illustration of the model structure.
Regional groups are arranged on a circular geographic structure, where the SoR stochastically moves between groups.
Each group contains individuals.
Each group and each individual independently adopt either $C$ (blue) or $D$ (red).
Numbers indicate group resource levels, which decrease with distance from the SoR.
Interaction structures exist at the group level and at the individual level.
  }
  \label{fig:3_model}
\end{figure}

In this model, there are $N_F$ individuals and $N_R$ groups.
An individual is an abstract representation of the minimal unit of human migration, such as a family.
A group represents the set of individuals within a geographically dispersed human habitat.

The geographical structure constrains the positions of groups and the migration of individuals.
It is defined as a circular graph, i.e., a ring structure, in which each group is connected to its two neighboring groups.
These connections remain fixed throughout the simulation.
The individuals are initially distributed evenly across all groups and can migrate between neighboring groups during the simulation.
The migration results in uneven spatial distributions of individuals over time, and some groups can be empty.

The interaction structures constrain the selection of opponents for cooperative or competitive interactions at two levels, i.e., the group level and the individual level.
There is a single group-level interaction structure in the model, while each group has its own individual-level interaction structure and no interactions occur between individuals belonging to different groups.
An interaction structure is represented by a weighted, undirected, complete graph whose edge weights are dynamic while its topology remains fixed.
The dynamic edge weight $w_{i,j}$ ($0 \leq w_{i,j} \leq 1$, initialized at $w_0$) denotes the strength of the relationship between nodes $i$ and $j$, where a node represents either a group or an individual, and is proportional to the probability of interaction between them.

Given these structural foundations, the simulation proceeds in four stages: EV, game, migration, and strategy update.
Game and strategy updates occur at both the group and individual levels, in that order.
Each stage is described in the following subsections.

\subsection*{Environmental variability}\label{sec:ev}

The model captures a key feature of the EV observed during the MSA in Africa, namely the unpredictable shifts in the geographical distribution of resources.

To represent this type of variability, we define the source of resources (SoR) as a dynamic point corresponding to the most resource-abundant region.
The SoR moves stochastically across the regional groups at each simulation time step.
This stochastic movement is formalized as
\begin{equation}
x_{t+1} =
\begin{cases}
\left[ (x_t + \Delta_t - 1) \bmod N_R \right] + 1, & \text{with probability } p_{EV}, \\
x_t, & \text{otherwise},
\end{cases}
\end{equation}
where $x_t$ denotes the index on the circular graph of regional groups indicating the position of the SoR at time $t$, $\Delta_t \in \{-1, +1\}$ is chosen with equal probability, and $p_{EV}$ is a key parameter controlling the intensity of the EV.

The group at which the SoR is located receives a resource value of $1$.
The amount of resources allocated to other groups decreases with their distance from the SoR along the geographical structure, reaching $0$ for the group farthest from the SoR.
This resource allocation is formalized as
\begin{equation}
r_i^R = 1 - \frac{d_i}{\left\lfloor \frac{N_R}{2} \right\rfloor}
\end{equation}
where $r_i^R$ denotes the resources received by group $i$, and $d_i$ is the distance between group $i$ and the SoR, calculated with periodic boundary conditions.
The resources of each group are evenly shared among its individuals.

\subsection*{Game}\label{sec:game}

Interactions that affect gains and losses of resources, both between groups and between individuals, are modeled using a game-theoretic framework.
For simplicity, we occasionally use the term \textit{agent} as a general label for both group agents and individual agents throughout this chapter.
Agent $i$ adopts a strategy $s_i \in \{C, D\}$, where $C$ denotes cooperation and $D$ denotes defection.
The interaction dynamics consist of three sequential phases:
opponent selection,
a pairwise public goods game (PGG), and
an update of the interaction structure.

The opponent selection is based on the relationships between agents specified by the edge weights of the interaction structure.
Each agent $i$ stochastically selects another agent as its opponent, with the probability of selecting agent $j$ given by
\begin{equation}
P(j|i) = \frac{w_{i,j}}{\sum_{k \neq i} w_{i,k}} .
\label{eq:opponent_selection}
\end{equation}

Each selected pair then engages in a pairwise PGG.
Here, we employ a pairwise PGG rather than traditional pairwise games such as the Prisoner’s Dilemma Game and the Stag Hunt Game in order to incorporate both the resource value of each agent and the relationships into the game.
In the game between agent $i$ and $j$, both contribute their respective amounts $c_i$ and $c_j$; the total contribution is multiplied by a constant factor $b$, and the amplified resources are then shared equally between them.
Specifically, $c_i$ is defined as
\begin{equation}
c_i =
\begin{cases}
r_i \times w_{i,j}, & \text{if } s_i = C, \\
0, & \text{if } s_i = D
\end{cases}
\end{equation}
where $r_i$ denotes the resource available to agent $i$.
In summary, the payoff matrix for agents $i$ and $j$ is
\begin{equation}
\begin{array}{c|cc}
      & C & D \\
\hline
C & \frac{(c_i + c_j) b}{2} - c_i, \frac{(c_i + c_j) b}{2} - c_j & \frac{c_i b}{2} - c_i, \frac{c_j b}{2} \\
D & \frac{c_i b}{2}, \frac{c_j b}{2} - c_j & 0, 0 .
\end{array}
\end{equation}

Finally, the edge weights of the interaction structure are updated to reflect the outcomes of the pairwise games.
Because agents benefit from being connected to $C$ but not to $D$, the direction of change depends on the combination of strategies.
When $C$–$C$, each has an incentive to strengthen the tie, and the relationship becomes stronger.
When $C$–$D$ or $D$–$C$, one side tends to strengthen while the other tends to weaken the tie; these opposing tendencies cancel out, and the relationship remains unchanged.
When $D$–$D$, each has an incentive to weaken the tie, and the relationship becomes weaker.
Formally, the update of the edge weights is given by
\begin{equation}
w_{i,j}' = w_{i,j} + (T - w_{i,j}) \Delta w ,
\end{equation}
where $\Delta w$ ($0 \leq \Delta w \leq 1$) denotes the update rate, and the target value $T$ is set to $1$ if $C$–$C$, $w_{i,j}$ if $C$–$D$ or $D$–$C$, and $0$ if $D$–$D$.

\subsection*{Migration}\label{sec:migration}

Individuals facing resource scarcity stochastically migrate to an adjacent regional group in search of better conditions.
Specifically, the probability that migration occurs is given by
\begin{equation}
  \max\left(1 - \tfrac{r_i^F}{\theta_F}, 0\right) \cdot p_M ,
\end{equation}
where $r_i^F$ denotes the resource available to individual $i$, $\theta_R$ ($0 < \theta_R < 1$) is the universal resource threshold shared by all groups, $\theta_F$ is the per-individual threshold obtained by $\theta_F = \tfrac{\theta_R}{N_F / N_R}$, and $p_M$ is a parameter controlling the frequency of migration events.

The migration direction is also probabilistic:
with probability $p_{SoR}$, the individual moves to the neighboring group closer to the SoR;
otherwise, it chooses randomly between the two neighboring groups.

Upon migration, the individual establishes new relationships in the destination group, and discards all previous ones.
Specifically, the edge weights between the individual and the others in the destination group are set to $w_0$, and the edge weights between the individual and the others in the original group are set to $0$.

\subsection*{Strategy update}\label{sec:strategy}

Agents stochastically update their strategies in response to resource scarcity.
Specifically, the probability that an update occurs is given by $\max \left(1 - \tfrac{r_i}{\theta}, 0\right) \cdot p_{SU}$, where $p_{SU}$ is a parameter controlling the frequency of strategy update events.
An agent $i$ that updates its strategy stochastically selects another agent $j$ as its role model from the appropriate pool: group agents select from all other group agents, while individual agents select from other individuals within the same group.
The probability of selecting agent $j$ is given by
\begin{equation}
Q(j|i) = \frac{r_j}{\sum_{\substack{k \neq i \\ r_k > \theta}} r_k}
\end{equation}
where $\theta$ denotes the relevant threshold, i.e., $\theta_R$ at the group level and $\theta_F$ at the individual level.
The adopted strategy is then subject to mutation with probability $\mu$, resulting in a stochastic switch between $C$ and $D$.
After the update, all edges of the updated agent are reset to the baseline weight $w_0$.

\subsection*{Evaluation}\label{sec:evaluation}

To examine how EV and migration influence the evolution of cooperation, we conduct simulations across a range of parameter settings, as summarized in Table~\ref{tab:3_params}.
For each setting, $100$ independent runs of $10000$ generations are carried out. 
As the principal performance indicators, we calculate the cooperation rates $\phi_R^C$ and $\phi_F^C$, defined as the average proportions of groups and individuals, respectively, employing strategy $C$ during the last $5000$ generations and averaged over all runs.

\begin{table}[!ht]
\centering
\caption[Model parameters used in the simulations]{Model parameters used in the simulations.}
\label{tab:3_params}
\begin{tabular}{cp{0.6\textwidth}p{0.2\textwidth}}
\toprule
\textbf{Parameter} & \textbf{Description} & \textbf{Value options} \\
\midrule
$N_R$ & Number of group agents & $\{10, 20, 40, 80\}$ \\
$N_F$ & Number of individual agents & $\{100, 200, 400, 800,$ $1600, 3200, 6400\}$\\
$\phi_C^0$ & Initial frequency of cooperators & $\{0, 0.5, 1\}$ \\
\addlinespace
$w_0$ & Initial edge weight & $\{0, 0.1, \ldots, 1\}$ \\
\addlinespace
$p_{EV}$ & Probability of SoR shift; controlling the intensity of EV ($\sigma_R$ (shift range of the SoR) in Chapter~\ref{ch:2_base_model}) & $\{0, 0.1, \ldots, 1\}$ \\
\addlinespace
$\theta_R$ & Resource threshold at group level & $0.5$ \\
\addlinespace
$b$ & Multiplication factor for PGG & $\{1, 1.1, \ldots, 2\}$ \\
\addlinespace
$\Delta w$ & Update rate of edge weights & $\{0, 0.1, \ldots, 1\}$ \\
\addlinespace
$p_M$ & Probability factor multiplied by resource deficit for migration events, controlling the individual mobility (direct probability for agents below threshold in Chapter~\ref{ch:4_2D_model}) & $\{0, 0.1, \ldots, 1\}$ \\
\addlinespace
$p_{SoR}$ & Probability of migrating toward SoR & $\{0, 0.1, \ldots, 1\}$ \\
\addlinespace
$p_{SU}$ & Probability factor for strategy update events & $0.1$ \\
\addlinespace
$\mu$ & Mutation probability in strategy update & $\{0, 0.01, 0.05, 0.1\}$ \\
\bottomrule
\end{tabular}
\end{table}

\section{Results}\label{sec_results}

\subsection*{Key results: influence of environmental variability and migration}

We conducted computational experiments to investigate how the EV ($p_{EV}$) and the migration ($p_M$) affect the cooperation rates at the group level ($\phi_C^R$) and the individual level ($\phi_C^F$).

Both $\phi_C^R$ and $\phi_C^F$ increase with $p_{EV}$, though with different patterns.
At the group level (Figure~\ref{fig:result1_1}a), $\phi_C^R$ values are around $0.5$ at $p_{EV} = 0$, increase sharply to approximately $0.7$ by $p_{EV} = 0.1$, and then increase gradually to approximately $0.8$ for $p_{EV} > 0.1$.
This pattern does not depend on $p_M$.
At the individual level (Figure~\ref{fig:result1_1}b), $\phi_C^F$ values are below $0.1$ at $p_{EV} = 0$ except at $p_M = 0$;
however, they increase steeply by $p_{EV} = 0.1$ and plateau at levels determined by $p_M$ for $p_{EV} > 0.1$.

While $p_M$ does not affect $\phi_C^R$ (Figure~\ref{fig:result1_1}c), $p_M$ significantly influences $\phi_C^F$ (Figure~\ref{fig:result1_1}d).
When $p_{EV} > 0$, $\phi_C^F$ is approximately $0.6$ at $p_M = 0$, increases to $0.8$--$0.9$ at $p_M = 0.1$, and then decreases linearly for $p_M > 0.1$.
In contrast, when $p_{EV} = 0$, $\phi_C^F$ starts at approximately $0.45$ at $p_M = 0$ and declines rapidly as $p_M$ increases.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=1.0\textwidth]{figures/3/Result1_1}
  \caption[Average cooperation rates as functions of $p_{EV}$ and $p_M$]{
Average cooperation rates as functions of $p_{EV}$ and $p_M$.
(a) $\phi_C^R$ vs. $p_{EV}$ for different $p_M$ values.
(b) $\phi_C^F$ vs. $p_{EV}$ for different $p_M$ values.
(c) $\phi_C^R$ vs. $p_M$ for different $p_{EV}$ values.
(d) $\phi_C^F$ vs. $p_M$ for different $p_{EV}$ values.
Each data point represents the mean across 100 independent trials, where each trial is averaged over the final 5000 generations.
Other parameters: $N_R = 10$, $N_F = 100$, $\phi_C^0 = 0.5$, $w_0 = 0.3$, $\theta_R = 0.5$, $b = 1.9$, $\Delta w = 0.1$, $p_{SoR} = 0.1$, $\mu = 0.01$.
  }
  \label{fig:result1_1}
\end{figure}

Figure~\ref{fig:result1_2} shows standard deviations corresponding to Figure~\ref{fig:result1_1}.
Although the mean values exhibit clear patterns (Figure~\ref{fig:result1_1}), the high inter-trial variability arises because $\phi_C^R$ and $\phi_C^F$ do not stabilize over time within each individual trial, with different trials converging toward either $0$ or $1$.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=1.0\textwidth]{figures/3/Result1_2}
  \caption[Standard deviations corresponding to Figure~\ref{fig:result1_1}]{
Standard deviations corresponding to Figure~\ref{fig:result1_1}.
  }
  \label{fig:result1_2}
\end{figure}

\subsection*{Primary drivers of the key results}

To examine the direction of influence between the group-level and individual-level processes, we conducted ablation experiments by selectively disabling specific model components.
The results show that disabling individual-level games, migration, and strategy updates does not significantly affect $\phi_C^R$ values (compare Figure~\ref{fig:result1_1}a,c to Figure~\ref{fig:mechanism1_1}a,c), whereas disabling group-level games and strategy updates markedly suppresses $\phi_C^F$ values (compare Figure~\ref{fig:result1_1}b,d to Figure~\ref{fig:mechanism1_1}b,d).
This asymmetry indicates that group-level processes contribute to individual-level cooperation, while the reverse influence is minimal.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=1.0\textwidth]{figures/3/Result1_3}
  \caption[Ablation experiments corresponding to Figure~\ref{fig:result1_1}]{
Ablation experiments corresponding to Figure~\ref{fig:result1_1}.
(a) and (c) show $\phi_C^R$ when individual-level games, migration, and strategy updates are disabled.
(b) and (d) show $\phi_C^F$ when group-level games and strategy updates are disabled.
Comparison with Figure~\ref{fig:result1_1} reveals that $\phi_C^R$ maintains similar patterns regardless of individual-level processes, whereas $\phi_C^F$ is substantially reduced without group-level processes.
All other conditions are identical to Figure~\ref{fig:result1_1}.
  }
  \label{fig:mechanism1_1}
\end{figure}

The evolution of group-level cooperation by EV can be explained by temporal resource distribution patterns (Figure~\ref{fig:mechanism1_2}).

When $p_{EV} = 0$, the resource-rich region remains fixed at group $1$, creating persistent spatial inequality where groups near the SoR remain resource-rich and maintain stable strategies, while distant groups experience resource scarcity and undergo frequent strategy updates (Figure~\ref{fig:mechanism1_2}a).
This spatial segregation prevents the formation of stable cooperative networks across all groups.

In contrast, when $p_{EV} > 0$, the location of the resource-rich region shifts over time, ensuring that all groups experience both resource-rich and resource-poor periods.
This temporal equity increases the long-term value of maintaining cooperative relationships through group-level games.
As shown in Figure~\ref{fig:mechanism1_2}c, cooperative networks gradually form and stabilize throughout the population.
Groups adopting $C$ strategies build strong reciprocal relationships, while defecting groups become isolated.
These cooperative networks provide robustness against both resource fluctuations and occasional mutations.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=1.0\textwidth]{figures/3/Result1_4}
  \caption[Temporal evolution of group-level cooperation]{
Temporal evolution of group-level cooperation.
The horizontal axis represents generation, and the vertical axis represents group index.
Blue indicates $C$ and red indicates $D$.
(a) shows the case where $p_{EV} = 0$ with the resource-rich region fixed at group $1$.
(b) shows the case where $p_{EV} = 0.1$ with a shifting resource-rich region.
Occasional mutations introduce $D$, but they quickly revert to $C$.
(c) shows the transition of the sum of weights between $C$ and $C$.
All other conditions are identical to Figure~\ref{fig:result1_1}.
  }
  \label{fig:mechanism1_2}
\end{figure}

The evolution of individual-level cooperation (Figure~\ref{fig:mechanism1_3}a) by EV can be explained by temporal resource fluctuations in a group and relationship formation between cooperators.

When $p_{EV} = 0$, the resource distribution across groups remains fixed, leading to population concentration around the resource-rich groups.
Since resources are shared equally among individuals within each group, this concentration equalizes per-capita resources across all groups (Figure~\ref{fig:mechanism1_3}b).
In this equilibrium state, defectors outcompete cooperators due to PGG rules: cooperators invest resources while defectors receive resources without contributing (Figure~\ref{fig:mechanism1_3}c).
Consequently, resource-poor cooperators undergo strategy updates and imitate high-resource defectors as role models, leading to the dominance of defectors.

In contrast, when $p_{EV} > 0$, stochastic SoR movement dynamically reshapes the resource distribution and causes previously poor groups to become rich and vice versa.
Because migration requires time, disparities in per-capita resources between groups occasionally emerge after each SoR movement (Figure~\ref{fig:mechanism1_3}b).
In newly enriched groups, cooperators' resources exceed the threshold, preventing both migration and strategy updates.
These stable cooperators repeatedly interact with each other, gradually strengthening their mutual relationships, while defector relationships decline, isolating them from profitable interactions.
Naturally, the groups can become poor.
Even in that case, the strong relationships once established between cooperators enable them to maintain high resource levels through high-payoff mutual cooperation, while defectors with weak relationships remain isolated from profitable interactions.
Through this process, cooperators become robust against resource fluctuations and seldom undergo migration and strategy updates, while defectors undergo migration and strategy updates more frequently (Figure~\ref{fig:mechanism1_3}c).

\begin{figure}[H]
  \centering
  \includegraphics[width=1.0\textwidth]{figures/3/Result1_5}
  \caption[Evolution of individual-level cooperation and resource dynamics]{
Evolution of individual-level cooperation and resource dynamics.
(a) Cooperation rate at the individual level ($\phi_C^F$) over time: when $p_{EV} = 0$, $\phi_C^F$ declines to near zero, while when $p_{EV} = 0.1$, $\phi_C^F$ reaches and maintains high levels.
(b) Standard deviation (SD) of mean individual-level resources between groups over time: when $p_{EV} = 0$, the SD converges to near zero as resources equalize across groups, while when $p_{EV} = 0.1$, stochastic SoR movement maintains persistent fluctuations in resource disparities between groups.
(c) Difference in mean resources between $C$ and $D$ within groups over time: when $p_{EV} = 0$, the difference remains small and negative, while when $p_{EV} = 0.1$, $C$ consistently maintain substantially higher resources than $D$ within the same groups.
All other conditions are identical to Figure~\ref{fig:result1_1}.
  }
  \label{fig:mechanism1_3}
\end{figure}

\subsection*{Influence of population-related parameters}

Figure~\ref{fig:result2_1} shows the effects of population size parameters $N_R$ and $N_F / N_R$ on cooperation rates $\phi_C^R$ and $\phi_C^F$ under different environmental and migration conditions $(p_{EV}, p_M)$.
When $(p_{EV}, p_M) = (0.0, 0.0)$, both $N_R$ and $N_F / N_R$ have negligible effects on $\phi_C^R$ and $\phi_C^F$ (Figure~\ref{fig:result2_1}a,b).
When $(p_{EV}, p_M) = (0.0, 0.1)$, $\phi_C^R$ remains unaffected by population sizes (Figure~\ref{fig:result2_1}c), whereas $\phi_C^F$ increases with both $N_R$ and $N_F / N_R$ (Figure~\ref{fig:result2_1}d).
When $(p_{EV}, p_M) = (0.5, 0.0)$, $\phi_C^R$ decreases slightly as $N_F / N_R$ increases but remains largely unaffected by $N_R$ (Figure~\ref{fig:result2_1}e).
At the individual level, $\phi_C^F$ decreases slightly with increasing $N_R$, but increases modestly with increasing $N_F / N_R$ (Figure~\ref{fig:result2_1}f).
These patterns observed under $(p_{EV}, p_M) = (0.5, 0.0)$ remain essentially unchanged when $(p_{EV}, p_M) = (0.5, 0.1)$ (Figure~\ref{fig:result2_1}g,h).

\begin{figure}[H]
  \centering
  \includegraphics[width=0.95\textwidth]{figures/3/Result2_1}
  \caption[Effects of population size parameters]{
Effects of population size parameters $N_R$ and $N_F / N_R$ on the cooperation rates $\phi_C^R$ and $\phi_C^F$.
The left panel column (a,c,e,g) shows the group-level cooperation rates $\phi_C^R$, and the right panel column (b,d,f,h) shows the individual-level cooperation rates $\phi_C^F$.
Each panel row corresponds to a different parameter setting of $(p_{EV}, p_M)$.
  }
  \label{fig:result2_1}
\end{figure}

These patterns can be explained as follows.
The group-level cooperation rate is insensitive to population size parameters for the following reasons.
Regarding $N_R$, because the resource allocation is normalized such that the group at the SoR receives $1.0$ and the most distant group receives $0.0$ regardless of the number of groups, increasing $N_R$ does not change the range of resource values that groups experience.
Regarding $N_F / N_R$, group-level dynamics are governed solely by intergroup relationships and EV, independently of the number of individuals within groups.
At the individual level, larger $N_F / N_R$ generally promotes cooperation because more individuals within each group increases the absolute number of cooperators even if the proportion of cooperators is the same, enabling them to form mutual relationships that are more robust against exploitation by defectors.
The effect of $N_R$ on $\phi_C^F$ depends on whether EV is present:
without EV ($p_{EV} = 0$), increasing $N_R$ increases the number of groups with moderate resource levels around the SoR, enabling cooperators to remain in the same group and strengthen the relationships among them.
with EV ($p_{EV} > 0$), increasing $N_R$ increases the frequency of migration, thereby limiting opportunities for cooperators to form stable networks within their groups.

The initial cooperation rate $\phi_C^0$ influences the evolutionary outcomes (Figure~\ref{fig:result2_2}).
When $\phi_C^0 = 0$ (lower area in each panel of Figure~\ref{fig:result2_2}), cooperation rates are lower overall compared to $\phi_C^0 = 0.5$ (Figure~\ref{fig:result1_1}), but the qualitative patterns remain unchanged.
In contrast, when $\phi_C^0 = 1$, the patterns change dramatically.
Both $\phi_C^R$ and $\phi_C^F$ are approximately 1.0 when $p_{EV} = 0$ and decline as $p_{EV}$ increases (upper area in each panel of Figure~\ref{fig:result2_2}a,b).
Similar patterns are observed as $p_M$ increases (upper area in each panel of Figure~\ref{fig:result2_2}c,d).

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.95\textwidth]{figures/3/Result2_2}
  \caption[Effects of initial cooperation rate]{
Effects of initial cooperation rate $\phi_C^0$.
In each panel, the lower area shows the case where $\phi_C^0 = 0$, and the upper area shows the case where $\phi_C^0 = 1$.
(a) $\phi_C^R$ vs. $p_{EV}$ for different $p_M$ values.
(b) $\phi_C^F$ vs. $p_{EV}$ for different $p_M$ values.
(c) $\phi_C^R$ vs. $p_M$ for different $p_{EV}$ values.
(d) $\phi_C^F$ vs. $p_M$ for different $p_{EV}$ values.
All other conditions and the color scheme are identical to Figure~\ref{fig:result1_1}.
  }
  \label{fig:result2_2}
\end{figure}

The influence of $\phi_C^0$ reflects the difference between the emergence and maintenance of cooperation.
When $\phi_C^0 = 0$ or $0.5$, cooperation must emerge through mutation and strategy updating, which EV facilitates.
In contrast, when $\phi_C^0 = 1$, cooperative networks are already established; in stable environments ($p_{EV} = 0$), these networks persist because few agents fall below the resource threshold and undergo strategy updates, whereas EV and migration can disrupt these pre-existing networks.

\subsection*{Influence of network parameters}

The initial network weight $w_0$ negatively influences cooperation, with lower $w_0$ promoting cooperation at both levels (Figure~\ref{fig:result3}a,b).
This occurs because $w_0$ determines the interaction strength with newcomers introduced through migration or strategy updates.
When $w_0$ is small, newcomers have weak initial relationships with existing members, limiting their immediate impact on the system.
If a newcomer adopts $D$, the low $w_0$ prevents strong interactions that could disrupt established cooperative networks.
In contrast, when $w_0$ is large, defecting newcomers immediately engage in strong interactions with $C$, potentially destabilizing the cooperative network and reducing overall cooperation rates.

The update rate of relationship weights $\Delta w$ positively affects cooperation, with higher $\Delta w$ promoting cooperation at both levels (Figure~\ref{fig:result3}c,d).
Higher $\Delta w$ values enable relationship weights between $C$ pairs to rapidly increase and those between $D$ pairs to quickly decline, thereby accelerating the formation of cooperative networks.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=1.0\textwidth]{figures/3/Result3}
  \caption[Effects of initial network weight $w_0$ and relation weight update rate $\Delta w$ on cooperation rates]{
Effects of initial network weight $w_0$ and relation weight update rate $\Delta w$ on cooperation rates $\phi_C^R$ and $\phi_C^F$.
(a) $\phi_C^R$ vs. $w_0$ for different $(p_{EV}, p_M)$ values.
(b) $\phi_C^F$ vs. $w_0$ for different $(p_{EV}, p_M)$ values.
(c) $\phi_C^R$ vs. $\Delta w$ for different $(p_{EV}, p_M)$ values.
(d) $\phi_C^F$ vs. $\Delta w$ for different $(p_{EV}, p_M)$ values.
All other conditions are identical to Figure~\ref{fig:result1_1}.
  }
  \label{fig:result3}
\end{figure}

\subsection*{Influence of other parameters}

We examined the effects of several additional parameters: the SoR orientation ($p_{SoR}$), the PGG multiplier ($b$), and the mutation rate ($\mu$).
The parameter $p_{SoR}$ has no significant effect on cooperation rates.
Higher values of $b$ promote cooperation at both levels, as expected from standard PGG theory.
Higher $\mu$ values blur the patterns observed in mean cooperation rates while reducing inter-trial variability, but do not alter the qualitative patterns.
Since these results are either trivial or follow directly from model assumptions, detailed results are provided in the \nameref{appendix}.

\section{Summary}\label{sec:3_summary}

This chapter examined how EV and migration jointly influence the evolution of cooperation using a 2-level model with group agents and individual agents.
The results demonstrate the following key findings:
(i) the group-level cooperation rate gradually increases with the EV ($p_{EV}$);
(ii) the individual-level cooperation rate sharply increases by $p_{EV} = 0.1$ and plateaus for $p_{EV} > 0.1$;
(iii) unlike group-level cooperation, individual-level cooperation is strongly affected by migration: moderate migration ($p_M \approx 0.1$) maximizes cooperation, while excessive migration reduces it.
At both levels, EV promotes cooperation through the formation of cooperative networks that provide robustness against resource fluctuations, migration, and strategy updates, similar to the mechanism in the base model in Chapter~\ref{ch:2_base_model}.
A detailed comparison between the models is provided in Chapter~\ref{ch:5_conclusion}.

These findings demonstrate that EV can promote cooperation even when migration is incorporated.
The next chapter, Chapter~\ref{ch:4_2D_model}, examines the effects of EV and migration in a two-dimensional spatial structure without explicit group definitions.
